---
title: 选择正确的 Azure 托管选项
description: 了解 ASP.NET Web 应用程序适合使用哪个 Azure 迁移路径。
author: CESARDELATORRE
ms.author: cesardl
ms.date: 11/15/2017
ms.openlocfilehash: 20bdef0614d8d492c3724f5a0f74f5ec9b2aa032
ms.sourcegitcommit: 1cf4550df8ed3236d838f561f6177d14d89b5e44
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/16/2018
ms.locfileid: "49348219"
---
# <a name="choose-the-right-azure-hosting-option"></a><span data-ttu-id="25ab0-103">选择正确的 Azure 托管选项</span><span class="sxs-lookup"><span data-stu-id="25ab0-103">Choose the right Azure hosting option</span></span>

<span data-ttu-id="25ab0-104">本文档提供将现有 .NET Framework 应用程序从本地迁移到 Azure 时，可在 Azure 中使用多个选项的注意事项及其比较。</span><span class="sxs-lookup"><span data-stu-id="25ab0-104">This document provides multiple considerations and comparisons between the multiple choices you have in Azure when migrating your existing .NET Framework applications from on-premises to Azure.</span></span>

<span data-ttu-id="25ab0-105">将现有 .NET 应用程序迁移到 Azure 时要考虑的基本方面包括：</span><span class="sxs-lookup"><span data-stu-id="25ab0-105">The fundamental areas to consider when migrating existing .NET applications to Azure are:</span></span>

1.  <span data-ttu-id="25ab0-106">计算选项</span><span class="sxs-lookup"><span data-stu-id="25ab0-106">Compute choices</span></span>
2.  <span data-ttu-id="25ab0-107">数据库选项</span><span class="sxs-lookup"><span data-stu-id="25ab0-107">Database choices</span></span>
3.  <span data-ttu-id="25ab0-108">网络和安全注意事项</span><span class="sxs-lookup"><span data-stu-id="25ab0-108">Networking and security considerations</span></span>
4.  <span data-ttu-id="25ab0-109">身份验证和授权注意事项</span><span class="sxs-lookup"><span data-stu-id="25ab0-109">Authentication and authorization considerations</span></span>

## <a name="compute-choices"></a><span data-ttu-id="25ab0-110">计算选项</span><span class="sxs-lookup"><span data-stu-id="25ab0-110">Compute choices</span></span>

<span data-ttu-id="25ab0-111">将现有的 .NET Framework 应用程序迁移到 Azure 时，可以使用多个选项。</span><span class="sxs-lookup"><span data-stu-id="25ab0-111">When migrating existing .NET Framework applications to Azure you have multiple choices.</span></span>  <span data-ttu-id="25ab0-112">但是，由于 .NET Framework 依赖于 Windows，只能对基于 Windows 的计算服务使用以下选项。</span><span class="sxs-lookup"><span data-stu-id="25ab0-112">However, since .NET Framework depends on Windows, the following choices are limited to Windows-based compute services.</span></span>

<span data-ttu-id="25ab0-113">下表显示了一些比较和建议，帮助你为现有的 .NET 应用程序选择适当的计算迁移路径。</span><span class="sxs-lookup"><span data-stu-id="25ab0-113">The following table shows several comparisons and recommendations to help you choose the right compute migration path for your existing .NET application.</span></span>

|                 | <span data-ttu-id="25ab0-114">Azure VM</span><span class="sxs-lookup"><span data-stu-id="25ab0-114">Azure VMs</span></span> | <span data-ttu-id="25ab0-115">Azure 应用服务</span><span class="sxs-lookup"><span data-stu-id="25ab0-115">Azure App Service</span></span> | <span data-ttu-id="25ab0-116">Windows 容器</span><span class="sxs-lookup"><span data-stu-id="25ab0-116">Windows Containers</span></span> |
|-----------------|-----------|-------------------|--------------------|
|<span data-ttu-id="25ab0-117">使用时机</span><span class="sxs-lookup"><span data-stu-id="25ab0-117">When to use</span></span>      |<ul><li><span data-ttu-id="25ab0-118">应用程序严重依赖于服务器和本地 .msi 安装。</span><span class="sxs-lookup"><span data-stu-id="25ab0-118">Application has strong dependencies on the server and local .msi installations.</span></span></li><li><span data-ttu-id="25ab0-119">想要使用最简单的应用程序迁移路径</span><span class="sxs-lookup"><span data-stu-id="25ab0-119">You want the easiest application migration path</span></span></li></ul>|<span data-ttu-id="25ab0-120">应用在服务器上没有任何依赖项，只是一个能够访问数据库服务器的简洁 ASP.NET Web 应用（MVC、Web 窗体）或 N 层应用（Web API、WCF）。</span><span class="sxs-lookup"><span data-stu-id="25ab0-120">App has no dependencies on the server, it is just a clean ASP.NET web app (MVC, WebForm) or N-Tier app (Web API, WCf) accessing a database server.</span></span> |<ul><li><span data-ttu-id="25ab0-121">应用程序在原始服务器上存在依赖项，但可以在 Docker Windows 映像中包含这些依赖项。</span><span class="sxs-lookup"><span data-stu-id="25ab0-121">Application has dependencies on the original server but those dependencies can be included in the Docker Windows image.</span></span></li><li><span data-ttu-id="25ab0-122">想要将应用现代化，使其[随时可用于云 DevOps](https://docs.microsoft.com/dotnet/standard/modernize-with-azure-and-containers/lift-and-shift-existing-apps-devops/reasons-to-lift-and-shift-existing-net-apps-to-cloud-devops-ready-applications)</span><span class="sxs-lookup"><span data-stu-id="25ab0-122">Want to modernize the app so it is [Cloud DevOps-Ready](https://docs.microsoft.com/dotnet/standard/modernize-with-azure-and-containers/lift-and-shift-existing-apps-devops/reasons-to-lift-and-shift-existing-net-apps-to-cloud-devops-ready-applications)</span></span></li></ul>|
|<span data-ttu-id="25ab0-123">优点和好处</span><span class="sxs-lookup"><span data-stu-id="25ab0-123">Pros & benefits</span></span>  |<ul><li><span data-ttu-id="25ab0-124">最简单的迁移路径</span><span class="sxs-lookup"><span data-stu-id="25ab0-124">Easiest migration path</span></span></li><li><span data-ttu-id="25ab0-125">熟悉的环境。</span><span class="sxs-lookup"><span data-stu-id="25ab0-125">Familiar environment.</span></span> <span data-ttu-id="25ab0-126">部署环境是一个 VM，因此非常类似于本地服务器。</span><span class="sxs-lookup"><span data-stu-id="25ab0-126">Deployment environment is a VM so very similar to on-premises servers.</span></span></li></ul> |<span data-ttu-id="25ab0-127">持续进行 PaaS 维护，在 Azure 中管理和缩放应用的最简单方法。</span><span class="sxs-lookup"><span data-stu-id="25ab0-127">Ongoing PaaS maintenance, simplest way to manage and scale apps in Azure.</span></span> |<ul><li><span data-ttu-id="25ab0-128">应对未来需要，随时可用于云 DevOps，在应用的容器中包含依赖项。</span><span class="sxs-lookup"><span data-stu-id="25ab0-128">Prepared for the future, Cloud DevOps-Ready with dependencies included in the app’s containers.</span></span></li><li><span data-ttu-id="25ab0-129">几乎不需要重构 .NET/C# 代码。</span><span class="sxs-lookup"><span data-stu-id="25ab0-129">Almost no need to re-factor .NET /C# code.</span></span></li></ul> |
|<span data-ttu-id="25ab0-130">缺点</span><span class="sxs-lookup"><span data-stu-id="25ab0-130">Cons</span></span>             |<span data-ttu-id="25ab0-131">属于 IaaS。</span><span class="sxs-lookup"><span data-stu-id="25ab0-131">It is IaaS.</span></span> <span data-ttu-id="25ab0-132">维护费用高昂。</span><span class="sxs-lookup"><span data-stu-id="25ab0-132">Maintenance is costly.</span></span> <span data-ttu-id="25ab0-133">必须管理 VM 基础结构的网络、负载均衡器、横向扩展和 IIS 管理等方方面面。</span><span class="sxs-lookup"><span data-stu-id="25ab0-133">You have to manage VMs infrastructure about networking, load-balancer, scale-out, IIS management, etc.</span></span> |<ul><li><span data-ttu-id="25ab0-134">并非[支持](http://www.migratetoazure.net/ReadinessAssessment)所有应用</span><span class="sxs-lookup"><span data-stu-id="25ab0-134">Not all apps are [supported](http://www.migratetoazure.net/ReadinessAssessment)</span></span></li><li><span data-ttu-id="25ab0-135">某些应用可能需要重构，甚至稍微调整体系结构，这样才能支持 Azure 应用服务。</span><span class="sxs-lookup"><span data-stu-id="25ab0-135">Some apps might need to be refactored and even slightly re-architected, so they support Azure App Service.</span></span></li></ul> |<ul><li><span data-ttu-id="25ab0-136">Docker 技能学习曲线</span><span class="sxs-lookup"><span data-stu-id="25ab0-136">Docker’s skills learning curve</span></span></li><li><span data-ttu-id="25ab0-137">需要更改某些代码和应用配置设置</span><span class="sxs-lookup"><span data-stu-id="25ab0-137">Some code and app configuration settings changes</span></span></li></ul>|
|<span data-ttu-id="25ab0-138">要求</span><span class="sxs-lookup"><span data-stu-id="25ab0-138">Requirements</span></span> |<span data-ttu-id="25ab0-139">Windows Server VM 的要求与本地应用相同</span><span class="sxs-lookup"><span data-stu-id="25ab0-139">Windows Server VM with the same requirements than the app for on-premises</span></span> | <span data-ttu-id="25ab0-140">[Azure 应用服务的兼容性分析](https://www.migratetoazure.net/Resources)中指定的 Azure 应用服务要求。</span><span class="sxs-lookup"><span data-stu-id="25ab0-140">Azure App Service requirements specified at the [Compatibility analysis for Azure App Service](https://www.migratetoazure.net/Resources).</span></span> |<ul><li>[<span data-ttu-id="25ab0-141">包含容器的 Windows Server 2016 - Azure VM</span><span class="sxs-lookup"><span data-stu-id="25ab0-141">Windows Server 2016 with Containers - Azure VM</span></span>](https://azuremarketplace.microsoft.com/marketplace/apps/Microsoft.WindowsServer?tab=Overview)<br /><span data-ttu-id="25ab0-142">或</span><span class="sxs-lookup"><span data-stu-id="25ab0-142">or</span></span></li><li><span data-ttu-id="25ab0-143">[Azure 容器服务 (AKS)](https://azure.microsoft.com/services/container-service/)（即 Kubernetes 业务流程协调程序）</span><span class="sxs-lookup"><span data-stu-id="25ab0-143">[Azure Container Service (AKS)](https://azure.microsoft.com/services/container-service/) (That is Kubernetes orchestrator)</span></span><br /><span data-ttu-id="25ab0-144">或</span><span class="sxs-lookup"><span data-stu-id="25ab0-144">or</span></span><li><span data-ttu-id="25ab0-145">[Azure Service Fabric](https://azure.microsoft.com/services/service-fabric/) 业务流程协调程序</span><span class="sxs-lookup"><span data-stu-id="25ab0-145">[Azure Service Fabric](https://azure.microsoft.com/services/service-fabric/) orchestrator</span></span></li></ul> |
|<span data-ttu-id="25ab0-146">如何迁移</span><span class="sxs-lookup"><span data-stu-id="25ab0-146">How to migrate</span></span> |<span data-ttu-id="25ab0-147">请参阅[迁移到 Azure 虚拟机](https://go.microsoft.com/fwlink/?linkid=862531)</span><span class="sxs-lookup"><span data-stu-id="25ab0-147">See [Migrate to Azure Virtual Machines](https://go.microsoft.com/fwlink/?linkid=862531)</span></span> | <span data-ttu-id="25ab0-148">请参阅[迁移 Azure 应用服务](https://go.microsoft.com/fwlink/?linkid=862532)</span><span class="sxs-lookup"><span data-stu-id="25ab0-148">See [Migrate Azure App Service](https://go.microsoft.com/fwlink/?linkid=862532)</span></span> | <span data-ttu-id="25ab0-149">遵循[使用 Azure 和 Windows 容器将现有 .NET 应用程序现代化电子书](https://aka.ms/liftandshiftwithcontainersebook)中的注意事项、方案和演练</span><span class="sxs-lookup"><span data-stu-id="25ab0-149">Follow considerations, scenarios and walkthroughs explained in the [Modernizing existing .NET apps with Azure and Windows Containers eBook](https://aka.ms/liftandshiftwithcontainersebook)</span></span> |

 <span data-ttu-id="25ab0-150">以下流程图显示了规划将现有 .NET Framework 应用程序迁移到 Azure 时可以使用的决策树，可以先尝试执行其中的选项 A（如果可行），不过，选项 B 是可执行的最简单路径。</span><span class="sxs-lookup"><span data-stu-id="25ab0-150">The following flowchart diagram shows a decision tree when planning a migration to Azure for your existing .NET Framework applications, being option A the first option to try and perform if it is viable, but option B the easiest path to perform.</span></span>

![显示托管决策树的流程图](media/dotnet-howto-choose-migration/decision-tree.png)

## <a name="database-choices"></a><span data-ttu-id="25ab0-152">数据库选项</span><span class="sxs-lookup"><span data-stu-id="25ab0-152">Database choices</span></span>

<span data-ttu-id="25ab0-153">将关系型数据库迁移到 Azure 时，可以使用多个选项。</span><span class="sxs-lookup"><span data-stu-id="25ab0-153">When migrating relational databases to Azure you have multiple choices.</span></span> <span data-ttu-id="25ab0-154">请参阅[将 SQL Server 数据库迁移到 Azure](https://go.microsoft.com/fwlink/?linkid=862533)，帮助自己选择适合现有 .NET 应用程序的数据库迁移路径。</span><span class="sxs-lookup"><span data-stu-id="25ab0-154">See [Migrate your SQL Server database to Azure](https://go.microsoft.com/fwlink/?linkid=862533) to help you choose the right database migration path for your existing .NET application.</span></span>

## <a name="networking-and-security-considerations"></a><span data-ttu-id="25ab0-155">网络和安全注意事项</span><span class="sxs-lookup"><span data-stu-id="25ab0-155">Networking and security considerations</span></span>

<span data-ttu-id="25ab0-156">将应用程序部署到 Microsoft Azure 等公有云时，可能需要通过[创建外围网络](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/)（例如，[Azure 与本地之间的外围网络](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-hybrid)，或 [Azure 与 Internet 之间的外围网络](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-dmz)），来隔离并保护特定的网络。</span><span class="sxs-lookup"><span data-stu-id="25ab0-156">When deploying applications to a public cloud like Microsoft Azure, you might want to isolate and secure certain networks by [creating network DMZs](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/), such as a [DMZ between Azure and on-premises](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-hybrid) or a [DMZ between Azure and the Internet](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-dmz).</span></span> <span data-ttu-id="25ab0-157">可以使用 [Azure 虚拟网络](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)实施外围网络。</span><span class="sxs-lookup"><span data-stu-id="25ab0-157">DMZs can be implemented with [Azure Virtual Network](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview).</span></span>
<span data-ttu-id="25ab0-158">使用 Azure 虚拟网络可以：</span><span class="sxs-lookup"><span data-stu-id="25ab0-158">Azure Virtual networks enable you to:</span></span>

- <span data-ttu-id="25ab0-159">构建可控的混合基础结构</span><span class="sxs-lookup"><span data-stu-id="25ab0-159">Build a hybrid infrastructure that you control</span></span>
- <span data-ttu-id="25ab0-160">自带 IP 地址和 DNS 服务器</span><span class="sxs-lookup"><span data-stu-id="25ab0-160">Bring your own IP addresses and DNS servers</span></span>
- <span data-ttu-id="25ab0-161">借助 IPsec VPN 或 ExpressRoute 确保连接安全</span><span class="sxs-lookup"><span data-stu-id="25ab0-161">Secure your connections with an IPsec VPN or ExpressRoute</span></span>
- <span data-ttu-id="25ab0-162">精细控制子网之间的流量</span><span class="sxs-lookup"><span data-stu-id="25ab0-162">Get granular control over traffic between subnets</span></span>
- <span data-ttu-id="25ab0-163">使用虚拟设备创建复杂的网络拓扑</span><span class="sxs-lookup"><span data-stu-id="25ab0-163">Create sophisticated network topologies using virtual appliances</span></span>
- <span data-ttu-id="25ab0-164">向应用程序提供独立且高度安全的环境</span><span class="sxs-lookup"><span data-stu-id="25ab0-164">Get an isolated and highly-secure environment for your applications</span></span>
 
<span data-ttu-id="25ab0-165">若要开始构建自己的虚拟网络，请参阅 [Azure 虚拟网络文档](https://docs.microsoft.com/azure/virtual-network/)。</span><span class="sxs-lookup"><span data-stu-id="25ab0-165">To get started building your own virtual network, see the [Azure Virtual Network documentation](https://docs.microsoft.com/azure/virtual-network/).</span></span>

## <a name="authentication-and-authorization-considerations-when-migrating-to-azure"></a><span data-ttu-id="25ab0-166">迁移到 Azure 时的身份验证和授权注意事项</span><span class="sxs-lookup"><span data-stu-id="25ab0-166">Authentication and authorization considerations when migrating to Azure</span></span>

<span data-ttu-id="25ab0-167">对于任何组织而言，迁移到云的最重要考虑因素是安全性。</span><span class="sxs-lookup"><span data-stu-id="25ab0-167">A top concern of any organization moving to the cloud is security.</span></span> <span data-ttu-id="25ab0-168">大多数公司已投入大量的时间、资金和工程力量来设计和开发安全模型，并且必须能够利用现有的投资，例如标识存储和单一登录解决方案。</span><span class="sxs-lookup"><span data-stu-id="25ab0-168">Most companies have invested a substantial amount of time, money, and engineering into designing and developing a security model, and it’s important that they’re able to leverage existing investments such as identity stores and single sign-on solutions.</span></span>

<span data-ttu-id="25ab0-169">本地运行的许多现有企业 B2E .NET 应用程序使用 Active Directory 进行身份验证和标识管理。</span><span class="sxs-lookup"><span data-stu-id="25ab0-169">Many existing enterprise B2E .NET applications running on-premises use Active Directory for authentication and identity management.</span></span>  <span data-ttu-id="25ab0-170">使用 Azure AD Connect 可将本地目录与 Azure Active Directory 集成。</span><span class="sxs-lookup"><span data-stu-id="25ab0-170">Azure AD Connect enables you to integrate your on-premises directories with Azure Active Directory.</span></span>  <span data-ttu-id="25ab0-171">若要开始集成，请参阅[将本地目录与 Azure Active Directory 集成](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect)。</span><span class="sxs-lookup"><span data-stu-id="25ab0-171">To get started, see [Integrate your on-premises directories with Azure Active Directory](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect).</span></span>

<span data-ttu-id="25ab0-172">请参阅[混合标识解决方案的标识要求](https://docs.microsoft.com/azure/active-directory/active-directory-hybrid-identity-design-considerations-business-needs)进行 Azure Active Directory 相关的其他规划。</span><span class="sxs-lookup"><span data-stu-id="25ab0-172">See [Identity requirements for your hybrid identity solution](https://docs.microsoft.com/azure/active-directory/active-directory-hybrid-identity-design-considerations-business-needs) for further planning related to Azure Active Directory.</span></span>

<span data-ttu-id="25ab0-173">其他身份验证协议选项包括消费型应用程序中经常使用的 [OAuth](https://en.wikipedia.org/wiki/OAuth) 和 [OpenID](https://en.wikipedia.org/wiki/OpenID)。</span><span class="sxs-lookup"><span data-stu-id="25ab0-173">Other authentication protocol choices are [OAuth](https://en.wikipedia.org/wiki/OAuth) and [OpenID](https://en.wikipedia.org/wiki/OpenID), which are common in consumer-facing applications.</span></span>  <span data-ttu-id="25ab0-174">使用自治标识数据库（例如，IdentityServer4 使用 OAuth 包装的 ASP.NET 标识 SQL 数据库）时，通常不需要与本地数据库或目录建立连接。</span><span class="sxs-lookup"><span data-stu-id="25ab0-174">When using autonomous identity databases, such as an ASP.NET Identity SQL database wrapped by IdentityServer4 using OAuth, no connectivity to on-premises databases or directories is usually required.</span></span>

## <a name="next-steps"></a><span data-ttu-id="25ab0-175">后续步骤</span><span class="sxs-lookup"><span data-stu-id="25ab0-175">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="25ab0-176">将 ASP.NET Web 应用程序迁移到 Azure 应用服务</span><span class="sxs-lookup"><span data-stu-id="25ab0-176">Migrate an ASP.NET web application to Azure App Service</span></span>](dotnet-howto-migrate-app-service.md)
